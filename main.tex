\documentclass[a4paper]{article}

%% Language and font encodings
\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}

%% Sets page size and margins
\usepackage[a4paper,top=3cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

%% Useful packages
\usepackage{mathptmx,amsmath,colonequals}
\usepackage{amssymb,gensymb,mathrsfs}
\usepackage{amscd,amsthm}
\usepackage{mathtools}
\usepackage{graphicx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage[shortlabels]{enumitem}
\usepackage{extarrows}
\usepackage{tikz,tikz-cd}
%\usepackage{hyperref}

\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{conj}[thm]{Conjecture}

%\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{ex}[thm]{Example}
\newtheorem{xca}[thm]{Exercise}

%\theoremstyle{remark}
\newtheorem{rmk}[thm]{Remark}

\newcommand{\arxiv}[1]{\href{http://arxiv.org/abs/#1}{{\tt arXiv:#1}}}

% convenient renaming
\newcommand{\isom}{\cong}
\newcommand{\ins}{\subset}
\newcommand{\dual}{\vee}
\newcommand{\cross}{\times}

% general text operators
\newcommand{\Image}{\operatorname{Im}}
\newcommand{\Coim}{\operatorname{Coim}}
\newcommand{\Ker}{\operatorname{Ker}}
\newcommand{\Coker}{\operatorname{Coker}}
\newcommand{\colim}{\operatorname{colim}}

% arrows
\newcommand{\surj}{\twoheadrightarrow}
\newcommand{\inj}{\xhookrightarrow{}}

% context
\newcommand{\basefield}{K}
\newcommand{\basering}{R}

% algebra
\newcommand{\category}[1]{\textsf{#1}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\Ext}{\operatorname{Ext}}
\newcommand{\Tor}{\operatorname{Tor}}
% TODO: put a \newcommand for the characteristic

% commutative algebra
%\newcommand{\depth}{\operatorname{depth}}
%\newcommand{\height}{\operatorname{height}}
%\newcommand{\pd}{\operatorname{pd}}
%\newcommand{\injd}{\operatorname{injd}}

% algebraic geometry
\newcommand{\Spec}{\operatorname{Spec}}
\newcommand{\Spa}{\operatorname{Spa}}

% custom ops here

% custom commands here

\title{A detailed proof of the adjunction formula}
\author{Jack J Garzella}

\begin{document}

\maketitle

\section{Milestone 1: Regular Varieties}

There are two (very closely related)
notions of ``smoothness'' given in Vakil Chatper 12.
The one we need for this proof is ``regularity''.

\begin{prop}
	Let \((R,\mathfrak{m},k)\) be a noetherian ring. 
	The following are equivalent:
	\begin{enumerate}[(a)]
		\item Let \(n\) be the minimal number of generators of
			\(\mathfrak{m}\).
			Then \(n = \dim R\).
		\item \(\dim \mathfrak{m} / \mathfrak{m}^{2}  = \dim R\)
	\end{enumerate}
\end{prop}


\begin{defn}
	Let \(R\) be a noetherian local ring.
	\(R\) is \textit{regular} if one (equivalently, all)
	of the conditions from the previous proposition holds.
\end{defn}

%TODO: define a regular scheme using this as the local definition

%% Smooth morphisms
%
%\begin{prop}
%	Let \(f: X \to Y\) 
%	be a map of schemes which is locally of finite
%	presentation (and thus locally of finite type).
%	The following are equivalent
%	\begin{enumerate}[(i)]
%		\item (Wikipedia Definition)
%			\(f\) is flat and for every geometric point
%			\(s : \overline{k} \to Y\), 
%			the fiber \(X_{s} := X \times_{Y} s\) 
%			is regular.
%		\item (Hartshorne Definition)
%			\(f\) is flat and the sheaf of relative
%			differentials \(\Omega_{X / Y}\) is 
%			locally free of rank equal to the 
%			relative dimension of \(f\).
%		\item (Vakil Definition)
%			For any \(x \in X\), there exists a neighborhood 
%			\(\Spec B\) of \(x\) and a neighborhood 
%			\(\Spec A\) of \(f(x)\) such that 
%			\(B = A[t_{1}, \ldots, t_{n}] / (P_{1}, \ldots, P_{m})\) 
%			and the Jacobian matrix has full rank, i.e.
%			the ideal generated by the \(m\)-by-\(m\) minors
%			of \((\partial P_{i} / \partial t_{j})\) is \(B\).
%			
%		\item \(f\) is formally smooth
%	\end{enumerate}
%\end{prop}
%
%\begin{def}
%	If any of the previous conditions is satisfied, 
%	the map \(f\) is said to be a \textit{smooth} morphism
%	of schemes.
%\end{def}
%
%\begin{def}
%	A \(k\)-scheme \(X\) is  \textit{smooth over \(k\)} if 
%	the structure map \(X \to k\) is smooth.
%\end{def}

\section{Milestone 2: Sheaf of Kahler differentials}

\begin{itemize}
	\item define the module of kahler differentials
	\item define the sheaf of kahler differentials
	\item prove that the conormal exact sequence is right-exact
\end{itemize}

\section{Milestone 3: Regularity implies conormal sequence is left-exact}

There are a few of this that I know of:

Hartshorne's proof, which needs
* nakayama's lemma (in mathlib)
* integral schemes
* a proper closed integral subscheme has codimension at least one

Vakil's proof, which needs
* associated primes
* geometric interpretation of associated primes

There are also three other proofs from stack exchange,
https://math.stackexchange.com/questions/846346/hartshorne-theorem-8-17

Ignacio Barros's proof:
* passes to stalks
* needs Hartshorne II.8.7, which should be doable with just 
   facts about differentials

Tomo's proof:
* Uses the concept of \textit{formally smooth} morphisms

user6's proof:
* passes to stalks, uses properties of free modules
* uses Nakayama's lemma

% conormal exact sequence

% Sketch of Hartshorne's proof:

% stuff => smooth
%  use nakayama's lemma, then compute the dimension of the z cotan space
% smooth => stuff
%  pick sub sheaf/variety for which it works on stalks, by first direction
%  this is regular and irreducible.
%  Then use the universal property integral closure (both schemes are integral)
%  (probably using integral <==> reduced and irred)

\section{Milestone 4: Alternate description of the conormal sheaf}

One ingredient we will need is 
\textit{the restriction of a sheaf to a subscheme}

\section{Milestone 5: The adjunction formula}

% the end goal

\begin{thm}[Adjunction Formula]
	Let \(X\) be a smooth variety and \(D\) a
	(smooth?) divisor. 
	Then 
	\[
		(K_{X} + D)|_{D} = K_{D}
	\] 
	
\end{thm}



\end{document}
